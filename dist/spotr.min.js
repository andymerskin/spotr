!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],t):"object"==typeof exports?exports.Spotr=t(require("lodash")):e.Spotr=t(e._)}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=1)}([function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),u=r.n(i),c=r(2),f=r.n(c);r.d(t,"Spotr",function(){return a});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){o(this,e),this.options=Object.assign({},t),this._collection=t.collection||[],this._keywords=t.keywords||{},this._fields=t.fields||{}}return s(e,[{key:"query",value:function(e){var t=this._filterKeywords(e),r=t.collection,n=t.query;return this._filterFields({collection:r,query:n}).collection}},{key:"_filterKeywords",value:function(e){var t=this,r=this.collection,o=e,i=u()(this._keywords).map(function(t,r){return{keyword:r,matches:t.queries.map(function(t){return{query:t,match:new RegExp("("+t+")[\\s]|("+t+")$","ig").test(e)}})}}).filter(function(e){return u.a.some(e.matches,function(e){return e.match})}).value();r=i.reduce(function(e,r){return(0,t._keywords[r.keyword].filter)(e)},[].concat(n(this.collection)));u()(i).flatMap(function(e){return e.matches}).filter(function(e){return e.match}).map(function(e){return e.query}).forEach(function(e){o=o.replace(e,"")});return o=o.trim(),{collection:r,query:o}}},{key:"_filterFields",value:function(e){var t=this,r=e.collection,n=e.query;return n.length?{collection:u()(r).map(function(e){return l({},e,{_score:u()(t._fields).reduce(function(t,r,o){return t=(t+f()(e[o],n,r.fuzzy))*r.boost},0)})}).filter(function(e){return e._score>0}).orderBy(["_score"],["desc"]).value()}:{collection:r}}},{key:"collection",get:function(){return this._collection},set:function(e){this._collection=e}}]),e}();t.default=a},function(e,t,r){e.exports=r(0).default},function(e,t){e.exports=function(e,t,r){"use strict";if(e===t)return 1;if(""===t)return 0;var n=0,o=e.toLowerCase(),i=e.length,u=t.toLowerCase(),c=t.length,f=0,l=1;r=r?1-r:0;for(var s=0;s<c;s+=1){var a=o.indexOf(u[s],f);if(a===-1){if(!r)return 0;l+=r}else{var p=0;f===a?p=.7:(p=.1," "===e[a-1]&&(p+=.8)),e[a]===t[s]&&(p+=.1),n+=p,f=a+1}}var d=.5*(n/i+n/c)/l;return u[0]===o[0]&&d<.85&&(d+=.15),d}},function(t,r){t.exports=e}])});