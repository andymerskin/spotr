---
interface Props {
  framework: string;
  example: string;
}

const { framework, example } = Astro.props;

// Map frameworks to their App file paths where spotr configuration lives
const frameworkAppFiles: Record<string, string> = {
  react: 'src/App.tsx',
  vue: 'src/App.vue',
  svelte: 'src/App.svelte',
  solid: 'src/App.tsx',
  preact: 'src/App.tsx',
};

const branch = 'master';
const repoPath = `andymerskin/spotr/tree/${branch}/examples/${framework}/${example}`;
const openFile = frameworkAppFiles[framework] ?? frameworkAppFiles.react;
---

<div
  class="w-full border border-neutral-600 rounded-lg overflow-hidden min-h-[80dvh]"
  id="stackblitz-embed"
  data-repo-path={repoPath}
  data-open-file={openFile}
>
</div>

<script>
  import sdk from '@stackblitz/sdk';

  const container = document.getElementById('stackblitz-embed');
  if (container) {
    const repoPath = container.dataset.repoPath ?? '';
    const openFile = container.dataset.openFile ?? 'src/App.tsx';

    sdk.embedGithubProject('stackblitz-embed', repoPath, {
      theme: 'dark',
      terminalHeight: 0,
      openFile,
    });
  }
</script>
