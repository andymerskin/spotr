---
import Layout from '../layouts/Layout.astro';
import Sidebar from '../components/Sidebar.astro';
import FrameworkTabs from '../components/FrameworkTabs.astro';
import StackBlitzEmbed from '../components/StackBlitzEmbed.astro';
import { examples } from '../data/examples';

export function getStaticPaths() {
  return examples.map((ex) => ({ params: { example: ex.slug } }));
}

const { example } = Astro.params;
const framework = Astro.url.searchParams.get('framework') ?? 'react';

const validExample = examples.find((e) => e.slug === example) ?? examples[0];
const exampleSlug = example ?? validExample.slug;
const exampleTitle = validExample.title;
---

<Layout title={exampleTitle}>
  <div class="flex min-h-screen bg-neutral-900">
    <Sidebar currentExample={exampleSlug} />
    <main class="ml-60 flex-1 p-8">
      <h1 class="text-2xl font-bold mb-4 text-neutral-100">{exampleTitle}</h1>
      <FrameworkTabs currentFramework={framework} example={exampleSlug} />
      <StackBlitzEmbed framework={framework} example={exampleSlug} />
    </main>
  </div>
</Layout>
